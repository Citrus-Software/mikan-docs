"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1486],{168:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/skull_mid_tpl-aa9dccc40de1d5361c33092ea2b5022a.png"},463:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"guides/facial_rig/templates","title":"Building the Facial Template Hierarchy","description":"Introduction","source":"@site/docs/guides/11-facial_rig/01-templates.md","sourceDirName":"guides/11-facial_rig","slug":"/guides/facial_rig/templates","permalink":"/mikan-docs/guides/facial_rig/templates","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Using Modifiers","permalink":"/mikan-docs/guides/modifiers/"},"next":{"title":"Setting Up the Modifiers","permalink":"/mikan-docs/guides/facial_rig/modifiers"}}');var r=s(4848),t=s(8453);const l={},o="Building the Facial Template Hierarchy",d={},c=[{value:"Introduction",id:"introduction",level:2},{value:"Skull, Skull_dn, Skull_mid",id:"skull-skull_dn-skull_mid",level:2},{value:"Lower face",id:"lower-face",level:2},{value:"Jaw, Jaw_up",id:"jaw-jaw_up",level:3},{value:"Lips group",id:"lips-group",level:3},{value:"Tongue and teeth",id:"tongue-and-teeth",level:3},{value:"c_mouth et c_corners",id:"c_mouth-et-c_corners",level:3},{value:"Mid face",id:"mid-face",level:2},{value:"Upper Face",id:"upper-face",level:2},{value:"Secondary offsets",id:"secondary-offsets",level:2},{value:"look at",id:"look-at",level:2},{value:"Facial interface",id:"facial-interface",level:2},{value:"Rigger section",id:"rigger-section",level:3},{value:"Animator section",id:"animator-section",level:3}];function a(e){const n={admonition:"admonition",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"building-the-facial-template-hierarchy",children:"Building the Facial Template Hierarchy"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,r.jsx)(n.p,{children:"Using the base building blocks provided by Mikan, it is possible to create a simple facial rig based on skin joints.\nAlthough this type of rig does not rely on shapes, it has been successfully used in many audiovisual productions and provides an excellent foundation."}),"\n",(0,r.jsx)(n.p,{children:"The overall process consists of:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"building a template-module hierarchy for the facial rig and its animator interface,"}),"\n",(0,r.jsx)(n.li,{children:"adding logic through modifiers to create the actual functioning of the rig,"}),"\n",(0,r.jsx)(n.li,{children:"recording facial poses in the animator interface."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"We begin by building the module hierarchy required for the facial rig. The body template is already in place (simple biped), enriched with clothing modules and extra features."}),"\n",(0,r.jsx)(n.p,{children:"We will now set up the facial template."}),"\n",(0,r.jsxs)(n.p,{children:["On the ",(0,r.jsx)(n.strong,{children:"Neck"})," module, we add a ",(0,r.jsx)(n.strong,{children:"core>group"})," module named ",(0,r.jsx)(n.strong,{children:"face"}),".\nTo do this, select the ",(0,r.jsx)(n.strong,{children:"head hook"})," of the Neck module, then add a group module."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"A group allows you to gather controllers and generate useful menus for animators (select, mirror, flip)."})}),"\n",(0,r.jsx)(n.h2,{id:"skull-skull_dn-skull_mid",children:"Skull, Skull_dn, Skull_mid"}),"\n",(0,r.jsxs)(n.p,{children:["We begin by creating three modules placed in parallel: ",(0,r.jsx)(n.strong,{children:"SKULL"}),", ",(0,r.jsx)(n.strong,{children:"SKULL_DN"}),", and ",(0,r.jsx)(n.strong,{children:"SKULL_MID"}),", which form the base for manipulating the global shape of the face."]}),"\n",(0,r.jsxs)(n.p,{children:["These modules are created using ",(0,r.jsx)(n.strong,{children:"core>joints"})," with the following options:"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"type"}),": ",(0,r.jsx)(n.strong,{children:"transform"}),", each element is parented in a simple hierarchy and scales accumulate,\n",(0,r.jsx)(n.strong,{children:"parentScale"}),": ",(0,r.jsx)(n.strong,{children:"off"}),", unnecessary with the transform type."]}),"\n",(0,r.jsx)(n.p,{children:"Once they are placed, enable toggle shapes to edit the controller shapes, then repeat the operation for each module."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"tpl skull",src:s(3212).A+"",width:"1200",height:"590"})}),"\n",(0,r.jsx)(n.h2,{id:"lower-face",children:"Lower face"}),"\n",(0,r.jsx)(n.h3,{id:"jaw-jaw_up",children:"Jaw, Jaw_up"}),"\n",(0,r.jsx)(n.p,{children:"Next, we add two modules to open the mouth: Jaw and Jaw_up, parented under skull_dn."}),"\n",(0,r.jsxs)(n.p,{children:["For this, we use ",(0,r.jsx)(n.strong,{children:"core>bones"})," modules, which create an FK hierarchy, with the following options:"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"rotate order"}),": ",(0,r.jsx)(n.strong,{children:"ZXY"})," (to reduce gimbal issues);\n",(0,r.jsx)(n.strong,{children:"add pose node"}),": ",(0,r.jsx)(n.strong,{children:"on"})," (to anticipate the creation of facial poses for mouth opening)."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"tpl jaw",src:s(526).A+"",width:"1200",height:"575"})}),"\n",(0,r.jsx)(n.h3,{id:"lips-group",children:"Lips group"}),"\n",(0,r.jsx)(n.p,{children:"Under skull_dn, we then create a Lips group.\nLike the face group, this group is used to gather all mouth controllers in the animator's right-click menu."}),"\n",(0,r.jsx)(n.p,{children:"Then we add:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"lip_up, lip_dn"}),": core>joints, type transform, to handle upper and lower lip movements."]}),"\n",(0,r.jsxs)(n.li,{children:["tweakers: ",(0,r.jsx)(n.strong,{children:"mouth1, 2, 3 up and dn"}),", plus ",(0,r.jsx)(n.strong,{children:"mouth4"}),": core>joints, type joint, to give animators the ability to sculpt the mouth as they wish."]}),"\n",(0,r.jsxs)(n.li,{children:["second level: ",(0,r.jsx)(n.strong,{children:"lip1, 2, 3 up and dn + lip4"}),": core>joints, type joint, scaleParent > on."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"tongue-and-teeth",children:"Tongue and teeth"}),"\n",(0,r.jsxs)(n.p,{children:["Under ",(0,r.jsx)(n.strong,{children:"jaw"}),", we add the lower teeth:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"teeth_dn"}),", ",(0,r.jsx)(n.strong,{children:"teeth_dn_tip"}),", ",(0,r.jsx)(n.strong,{children:"teeth_bend"}),", ",(0,r.jsx)(n.strong,{children:"teeth_bend_tip"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["All created as ",(0,r.jsx)(n.strong,{children:"core>joints"}),", type joint, with parent scale enabled."]}),"\n",(0,r.jsx)(n.li,{children:"Flip orient enabled for the teeth bend L/R."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Then we create the tongue:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"tongue_base"}),", type transform, to scale the entire tongue,"]}),"\n",(0,r.jsxs)(n.li,{children:["a chain of ",(0,r.jsx)(n.strong,{children:"core>bones with 3 joints"})," for the rest of the tongue, auto-oriented, with up axis X and up dir +X."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The same logic as the ",(0,r.jsx)(n.strong,{children:"lower teeth"})," is used for the upper teeth, parented under ",(0,r.jsx)(n.strong,{children:"jaw_up"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"tpl mouthLips",src:s(4699).A+"",width:"1200",height:"531"})}),"\n",(0,r.jsx)(n.h3,{id:"c_mouth-et-c_corners",children:"c_mouth et c_corners"}),"\n",(0,r.jsxs)(n.p,{children:["We add a global controller ",(0,r.jsx)(n.strong,{children:"c_mouth"})," as well as ",(0,r.jsx)(n.strong,{children:"c_corners"})," for the mouth corners, both using ",(0,r.jsx)(n.strong,{children:"core>joints"})," modules, type ",(0,r.jsx)(n.strong,{children:"transform"}),", with ",(0,r.jsx)(n.strong,{children:"flip orient"})," enabled for the ",(0,r.jsx)(n.strong,{children:"c_corners"}),"."]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"\ud83d\udc49 They will be connected later through the modifiers to the rest of the rig."})}),"\n",(0,r.jsx)(n.h2,{id:"mid-face",children:"Mid face"}),"\n",(0,r.jsx)(n.p,{children:"We add a nose module and nostrils modules."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"nose"}),": ",(0,r.jsx)(n.strong,{children:"core>joints"}),", type ",(0,r.jsx)(n.strong,{children:"joint"}),", parent scale ",(0,r.jsx)(n.strong,{children:"off"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"nostrils"}),": ",(0,r.jsx)(n.strong,{children:"core>joints"}),", type ",(0,r.jsx)(n.strong,{children:"joint"}),", parent scale ",(0,r.jsx)(n.strong,{children:"on"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"They stabilize the nasal area and connect the upper and lower parts of the face."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"tpl skukll mid",src:s(168).A+"",width:"1400",height:"624"})}),"\n",(0,r.jsx)(n.h2,{id:"upper-face",children:"Upper Face"}),"\n",(0,r.jsx)(n.p,{children:"For the upper part of the face, we add:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["an ",(0,r.jsx)(n.strong,{children:"Eyeroot"})," module, ",(0,r.jsx)(n.strong,{children:"core>joint"}),", type ",(0,r.jsx)(n.strong,{children:"joint"}),", with:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"L/R branches,"}),"\n",(0,r.jsx)(n.li,{children:"flip orient enabled,"}),"\n",(0,r.jsx)(n.li,{children:"rotate order : ZXY."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This module allows the eye to move and scale on the face."}),"\n",(0,r.jsx)(n.p,{children:"Then :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eye_socket"}),", core>xform, placed at the eye pivot,"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eye"}),", core>joint, type transform, rotate order zxy, used to control the rotation of the eye (ctrl and skin tags unchecked),"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eyeball"}),", core>joint, type transform, in preparation for the look-at rig."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For the eyelids:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eyelid_up"})," and ",(0,r.jsx)(n.strong,{children:"eyelid_dn"}),", core>joints, rotate order YZX,"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eyelid_bend_up"})," and ",(0,r.jsx)(n.strong,{children:"eyelid_bend_dn"}),", core>joints, type transform, rotate order YZX,"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eyelid_corner_ext"})," and ",(0,r.jsx)(n.strong,{children:"eyelid_corner_int"}),", same type as the bend modules,"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eyelids_socket_up"})," and ",(0,r.jsx)(n.strong,{children:"eyelids_socket_dn"}),", same modules as the bend ones."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Ears:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ear_base"}),": core>joint, type joint, used to slide the ear over the skull, and"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ear"}),": core>bones, rotate order ZXY, auto-orient, to move the ear itself."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Eyebrows:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eyebrow_base"}),": core>joint, type transform, used to control the global movement of the eyebrow, then"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"eyebrow1, 2 and 3"}),": core>joints, type joint, nb : 3, unchain, flip orient, for finer control."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"\ud83d\udc49 As always: for each template module, enable parent scale when needed, flip orient for branches, and do pose when required."})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"tpl face up",src:s(482).A+"",width:"1400",height:"619"})}),"\n",(0,r.jsx)(n.h2,{id:"secondary-offsets",children:"Secondary offsets"}),"\n",(0,r.jsx)(n.p,{children:"Adding modules to enrich the control over the cheek area:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"core>joints"}),", type ",(0,r.jsx)(n.strong,{children:"transform"}),","]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"flip orient"})," enabled,"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"do pose"})," enabled (anticipation of facial poses)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"tpl cheeks",src:s(3085).A+"",width:"1200",height:"530"})}),"\n",(0,r.jsx)(n.h2,{id:"look-at",children:"look at"}),"\n",(0,r.jsxs)(n.p,{children:["Next, we add a hierarchy to manage the ",(0,r.jsx)(n.strong,{children:"look-at system"})," with:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["an ",(0,r.jsx)(n.strong,{children:"eyes"})," module: core>joints, type transform, skin tag unchecked, placed between the two eyes,"]}),"\n",(0,r.jsxs)(n.li,{children:["a ",(0,r.jsx)(n.strong,{children:"look_at"})," module, identical but placed in front of the face, controlling the gaze direction of both eyes,"]}),"\n",(0,r.jsxs)(n.li,{children:["a ",(0,r.jsx)(n.strong,{children:"look_target"})," module, used to control each eye individually."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"tpl look_at",src:s(1151).A+"",width:"1400",height:"612"})}),"\n",(0,r.jsx)(n.h2,{id:"facial-interface",children:"Facial interface"}),"\n",(0,r.jsxs)(n.p,{children:["To set up the ",(0,r.jsx)(n.strong,{children:"facial interface"})," intended for animators, we start with:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["a ",(0,r.jsx)(n.strong,{children:"face_panel"}),", created using a ",(0,r.jsx)(n.strong,{children:"core>xform"})," module, with the ",(0,r.jsx)(n.strong,{children:"parent = parent"})," option so that the panel group is attached to the face group."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"We then create the rigger section and the animator interface."}),"\n",(0,r.jsx)(n.h3,{id:"rigger-section",children:"Rigger section"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"shp_lids"}),": core>xform module where all blink and eyelid-movement parameters will be stored."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"shp_lips"}),": module for lip-related settings."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"chan_face"}),": centralizes and manages all facial-rig connections, in the spirit of the BCS plugin, by aggregating all attributes onto a single controller."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"shp_face"}),": node on which the facial poses will be recorded."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"animator-section",children:"Animator section"}),"\n",(0,r.jsx)(n.p,{children:"On the animator side, we set up the hierarchy used to build the interface:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"frame_look"}),", a core>xform module providing a 2D interface for eye animation.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["a look ",(0,r.jsx)(n.strong,{children:"core>joints"})," module for the global movement of both eyes,"]}),"\n",(0,r.jsxs)(n.li,{children:["a look_eye ",(0,r.jsx)(n.strong,{children:"core>joints"})," module for the individual movement of each eye,"]}),"\n",(0,r.jsxs)(n.li,{children:["a loc_look ",(0,r.jsx)(n.strong,{children:"core>xform"})," used to collect the movements of both c_look and c_look_eye."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"frame_lipsync"}),", a core>xform module for the 2D mouth-movement interface.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["a ",(0,r.jsx)(n.strong,{children:"lipsync"})," core>joints module to handle mouth opening."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"face_up"}),", a core>joints module grouping all upper-face poses (eyes, eyebrows)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"face_dn"}),", a core>joints module grouping all lower-face poses (mouth, teeth, cheeks)."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"tpl dace UI",src:s(5949).A+"",width:"1291",height:"595"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},482:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/eyes_tpl-3aef00084785aa94cba7284991a8a88a.png"},526:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/jaw_tpl-11384a823586d1476ce0667a861a6aed.png"},1151:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/look_at_tpl-660920b7e11e1d15a17adf7f8595f691.png"},3085:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/cheeks_tpl-bff1b1f1f2e1df48851bd094ba891759.png"},3212:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/skull_tpls-7c693ea6b8b0c5ba68835151a50b3c01.png"},4699:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/lips_tpls-1b1afab3c200139570622c71aa4425ef.png"},5949:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/faceUI_tpl-136070daf89660d5aa3539040cb38c54.png"},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);